<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ì£¼ì‚¬ìœ„ ê²Œì„</title>
    <style>
      :root {
        --bg: #0f172a;
        --panel: #111827;
        --muted: #9ca3af;
        --text: #e5e7eb;
        --accent: #22c55e;
        --danger: #ef4444;
        --primary: #3b82f6;
        --panel-2: #0b1220;
        --shadow: 0 10px 30px rgba(0,0,0,0.35);
      }
      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        background: radial-gradient(1200px 700px at 20% 10%, #0b1220, #0a0f1d 40%, #05070d 100%), var(--bg);
        color: var(--text);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
        display: grid;
        place-items: center;
        padding: 24px;
      }

      .game {
        width: min(960px, 100%);
        background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        box-shadow: var(--shadow);
        overflow: hidden;
      }

      .header {
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: space-between;
        padding: 16px 20px;
        background: linear-gradient(180deg, rgba(17,24,39,0.9), rgba(17,24,39,0.6));
        border-bottom: 1px solid rgba(255,255,255,0.06);
      }
      .title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 700;
        letter-spacing: 0.3px;
      }
      .title .logo {
        width: 34px;
        height: 34px;
        display: grid;
        place-items: center;
        background: radial-gradient(circle at 30% 30%, #60a5fa 0%, #2563eb 60%, #1d4ed8 100%);
        color: white;
        border-radius: 10px;
        box-shadow: 0 8px 18px rgba(59, 130, 246, 0.4), inset 0 0 8px rgba(255,255,255,0.2);
        font-size: 18px;
      }
      .controls {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .controls .target {
        display: flex;
        align-items: center;
        gap: 8px;
        color: var(--muted);
        font-size: 14px;
      }
      .controls input[type="number"] {
        width: 84px;
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid rgba(255,255,255,0.12);
        background: rgba(255,255,255,0.06);
        color: var(--text);
        outline: none;
      }
      .btn {
        appearance: none;
        border: 1px solid rgba(255,255,255,0.1);
        background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
        color: var(--text);
        padding: 10px 14px;
        border-radius: 10px;
        font-weight: 600;
        letter-spacing: 0.2px;
        cursor: pointer;
        transition: transform 0.05s ease, background 0.2s ease, border 0.2s ease;
      }
      .btn:hover { transform: translateY(-1px); border-color: rgba(255,255,255,0.2); }
      .btn:active { transform: translateY(0); }
      .btn.primary { border-color: rgba(59,130,246,0.35); background: linear-gradient(180deg, rgba(59,130,246,0.35), rgba(59,130,246,0.15)); }
      .btn.success { border-color: rgba(34,197,94,0.35); background: linear-gradient(180deg, rgba(34,197,94,0.35), rgba(34,197,94,0.15)); }
      .btn.warn { border-color: rgba(239,68,68,0.35); background: linear-gradient(180deg, rgba(239,68,68,0.35), rgba(239,68,68,0.15)); }

      .board {
        display: grid;
        grid-template-columns: 1fr 300px;
        gap: 0;
      }
      @media (max-width: 860px) {
        .board { grid-template-columns: 1fr; }
      }

      .players {
        display: grid;
        grid-template-columns: 1fr 1fr;
        border-right: 1px solid rgba(255,255,255,0.06);
      }
      @media (max-width: 860px) {
        .players { border-right: none; border-bottom: 1px solid rgba(255,255,255,0.06); }
      }
      .player {
        padding: 22px 20px;
        position: relative;
        min-height: 180px;
      }
      .player.active { background: radial-gradient(800px 220px at 50% 0%, rgba(59,130,246,0.18), rgba(59,130,246,0.04) 60%, transparent); }
      .player.winner { background: radial-gradient(900px 240px at 50% 0%, rgba(34,197,94,0.2), rgba(34,197,94,0.05) 60%, transparent); }
      .player h2 {
        margin: 0 0 8px 0;
        font-size: 20px;
        font-weight: 800;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .badge {
        padding: 3px 8px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 700;
        color: white;
      }
      .badge.active { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
      .badge.winner { background: linear-gradient(90deg, #22c55e, #4ade80); }
      .score { font-size: 42px; font-weight: 900; margin: 10px 0 4px; }
      .total-label { color: var(--muted); font-size: 12px; letter-spacing: 0.3px; text-transform: uppercase; }

      .side {
        display: grid;
        gap: 14px;
        padding: 22px 20px;
      }
      .dice-area {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .die {
        aspect-ratio: 1 / 1;
        display: grid;
        place-items: center;
        border-radius: 14px;
        background: radial-gradient(circle at 30% 30%, #111827, #0b1220);
        border: 1px solid rgba(255,255,255,0.08);
        box-shadow: inset 0 4px 18px rgba(0,0,0,0.5), 0 8px 18px rgba(0,0,0,0.35);
        font-size: 48px;
        user-select: none;
        will-change: transform;
      }
      .die.roll { animation: shake 420ms cubic-bezier(.36,.07,.19,.97); }
      @keyframes shake {
        10%, 90% { transform: translate(-1px, 0) rotate(-0.5deg); }
        20%, 80% { transform: translate(2px, 0) rotate(1deg); }
        30%, 50%, 70% { transform: translate(-4px, 0) rotate(-1.5deg); }
        40%, 60% { transform: translate(4px, 0) rotate(1.5deg); }
      }

      .turn {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        align-items: center;
      }
      .turn .stat {
        background: linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.03));
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 12px;
        padding: 12px;
        text-align: center;
      }
      .turn .stat .label { color: var(--muted); font-size: 12px; }
      .turn .stat .value { font-size: 22px; font-weight: 800; margin-top: 4px; }

      .actions { display: flex; gap: 10px; }
      .footer {
        display: flex;
        gap: 10px;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px 18px;
        border-top: 1px solid rgba(255,255,255,0.06);
        color: var(--muted);
        font-size: 13px;
      }
      .kbd {
        border: 1px solid rgba(255,255,255,0.18);
        background: rgba(255,255,255,0.08);
        padding: 1px 6px;
        border-radius: 6px;
        font-weight: 700;
        color: var(--text);
      }

      .toast {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(20px);
        opacity: 0;
        transition: all .3s ease;
        background: rgba(3,7,18,0.9);
        border: 1px solid rgba(255,255,255,0.12);
        padding: 10px 14px;
        border-radius: 10px;
        box-shadow: var(--shadow);
        z-index: 50;
      }
      .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

      .modal-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.45);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 40;
      }
      .modal-backdrop.show { display: flex; }
      .modal {
        width: min(640px, 92%);
        background: linear-gradient(180deg, rgba(17,24,39,0.95), rgba(17,24,39,0.85));
        border: 1px solid rgba(255,255,255,0.12);
        border-radius: 14px;
        padding: 18px 18px 10px;
        color: var(--text);
        box-shadow: var(--shadow);
      }
      .modal h3 { margin: 6px 0 8px; }
      .modal p { margin: 8px 0; color: var(--muted); }
      .modal .close-row { display: flex; justify-content: flex-end; }
    </style>
  </head>
  <body>
    <div class="game" role="application" aria-label="ì£¼ì‚¬ìœ„ ê²Œì„">
      <div class="header">
        <div class="title">
          <div class="logo" aria-hidden="true">ğŸ²</div>
          <div>
            <div style="font-size:16px; opacity:.9">ì£¼ì‚¬ìœ„ ê²Œì„</div>
            <div style="font-size:12px; color:var(--muted)">ë£°: 1 ë‚˜ì˜¤ë©´ í„´ ì¢…ë£Œ, ëª©í‘œ ì ìˆ˜ ë¨¼ì € ë‹¬ì„±!</div>
          </div>
        </div>
        <div class="controls">
          <div class="target" title="ëª©í‘œ ì ìˆ˜">
            ëª©í‘œ ì ìˆ˜
            <input id="targetScore" type="number" min="10" max="500" step="5" value="100" />
          </div>
          <button id="helpBtn" class="btn" aria-label="ê·œì¹™ ë³´ê¸°">ê·œì¹™</button>
          <button id="resetBtn" class="btn" aria-label="ìƒˆ ê²Œì„">ìƒˆ ê²Œì„</button>
        </div>
      </div>

      <div class="board">
        <div class="players">
          <section class="player active" id="p0" aria-label="í”Œë ˆì´ì–´ 1">
            <h2>í”Œë ˆì´ì–´ 1 <span id="b0" class="badge active">ë‚´ í„´</span></h2>
            <div class="score" id="s0">0</div>
            <div class="total-label">ì´ ì ìˆ˜</div>
          </section>
          <section class="player" id="p1" aria-label="í”Œë ˆì´ì–´ 2">
            <h2>í”Œë ˆì´ì–´ 2 <span id="b1" class="badge" style="display:none">ë‚´ í„´</span></h2>
            <div class="score" id="s1">0</div>
            <div class="total-label">ì´ ì ìˆ˜</div>
          </section>
        </div>

        <aside class="side">
          <div class="dice-area">
            <div class="die" id="d1" aria-live="polite" aria-label="ì£¼ì‚¬ìœ„ 1">âš€</div>
            <div class="die" id="d2" aria-live="polite" aria-label="ì£¼ì‚¬ìœ„ 2">âš€</div>
          </div>
          <div class="turn">
            <div class="stat" aria-live="polite">
              <div class="label">ì´ë²ˆ í„´ ì ìˆ˜</div>
              <div class="value" id="turnScore">0</div>
            </div>
            <div class="stat">
              <div class="label">í˜„ì¬ í”Œë ˆì´ì–´</div>
              <div class="value" id="currentPlayer">í”Œë ˆì´ì–´ 1</div>
            </div>
          </div>
          <div class="actions">
            <button id="rollBtn" class="btn primary" aria-label="ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°">êµ´ë¦¬ê¸° (R/Space)</button>
            <button id="holdBtn" class="btn success" aria-label="ì ìˆ˜ ì €ì¥">ì €ì¥í•˜ê¸° (H)</button>
            <button id="forfeitBtn" class="btn warn" aria-label="í„´ í¬ê¸°">í„´ í¬ê¸°</button>
          </div>
        </aside>
      </div>

      <div class="footer">
        <div>í‚¤ë³´ë“œ: <span class="kbd">R</span>/<span class="kbd">Space</span> êµ´ë¦¬ê¸° Â· <span class="kbd">H</span> ì €ì¥ Â· <span class="kbd">N</span> ìƒˆ ê²Œì„</div>
        <div id="status">í–‰ìš´ì„ ë¹Œì–´ìš”! ğŸ¯</div>
      </div>
    </div>

    <div class="toast" id="toast" role="status" aria-live="polite"></div>
    <audio id="rollSound" preload="auto">
      <source src="C:\Users\sahaw\Downloads\videoplayback.mp3" type="audio/mpeg">
    </audio>

    <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="rulesTitle">
        <h3 id="rulesTitle">ê²Œì„ ê·œì¹™</h3>
        <p>
          ë‘ ëª…ì´ ë²ˆê°ˆì•„ê°€ë©° ë‘ ê°œì˜ ì£¼ì‚¬ìœ„ë¥¼ êµ´ë¦½ë‹ˆë‹¤. ë‚˜ì˜¨ ëˆˆì˜ í•©ì´ ì´ë²ˆ í„´ ì ìˆ˜ì— ë”í•´ì§‘ë‹ˆë‹¤.
          ë‹¨, ì–´ë–¤ ì£¼ì‚¬ìœ„ë¼ë„ 1ì´ ë‚˜ì˜¤ë©´ ì´ë²ˆ í„´ ì ìˆ˜ëŠ” 0ì ì´ ë˜ê³ , í„´ì´ ë„˜ì–´ê°‘ë‹ˆë‹¤.
        </p>
        <p>
          ì ì ˆí•  ë•Œ <b>ì €ì¥í•˜ê¸°</b>ë¥¼ ëˆŒëŸ¬ ì´ë²ˆ í„´ ì ìˆ˜ë¥¼ ìì‹ ì˜ ì´ ì ìˆ˜ì— ë”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          ë¨¼ì € ëª©í‘œ ì ìˆ˜ì— ë„ë‹¬í•˜ëŠ” í”Œë ˆì´ì–´ê°€ ìŠ¹ë¦¬í•©ë‹ˆë‹¤.
        </p>
        <div class="close-row">
          <button id="closeModal" class="btn">ë‹«ê¸°</button>
        </div>
      </div>
    </div>

    <script>
      const dieFaces = ["âš€","âš","âš‚","âšƒ","âš„","âš…"];

      const elements = {
        dice: [document.getElementById('d1'), document.getElementById('d2')],
        scores: [document.getElementById('s0'), document.getElementById('s1')],
        players: [document.getElementById('p0'), document.getElementById('p1')],
        badges: [document.getElementById('b0'), document.getElementById('b1')],
        turnScore: document.getElementById('turnScore'),
        currentPlayer: document.getElementById('currentPlayer'),
        status: document.getElementById('status'),
        toast: document.getElementById('toast'),
        target: document.getElementById('targetScore'),
        backdrop: document.getElementById('modalBackdrop'),
        closeModal: document.getElementById('closeModal'),
        helpBtn: document.getElementById('helpBtn'),
        resetBtn: document.getElementById('resetBtn'),
        rollBtn: document.getElementById('rollBtn'),
        holdBtn: document.getElementById('holdBtn'),
        forfeitBtn: document.getElementById('forfeitBtn')
      };

      const game = {
        totalScores: [0, 0],
        currentPlayerIndex: 0,
        turnAccumulated: 0,
        isOver: false,
        get targetScore() { return clamp(parseInt(elements.target.value || '100', 10), 10, 500); }
      };

      function clamp(value, min, max) { return Math.max(min, Math.min(max, value)); }
      function rand1to6() { return Math.floor(Math.random() * 6) + 1; }
      
      // Dice roll sound using MP3 file
      function playRollSound() {
        try {
          const audio = document.getElementById('rollSound');
          audio.currentTime = 0;
          audio.play().catch(() => { /* no-op */ });
        } catch (_) { /* no-op */ }
      }

      function showToast(message) {
        elements.toast.textContent = message;
        elements.toast.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(() => { elements.toast.classList.remove('show'); }, 1500);
      }

      function updateUI() {
        elements.scores[0].textContent = game.totalScores[0];
        elements.scores[1].textContent = game.totalScores[1];
        elements.turnScore.textContent = game.turnAccumulated;
        elements.currentPlayer.textContent = `í”Œë ˆì´ì–´ ${game.currentPlayerIndex + 1}`;

        elements.players.forEach((el, idx) => {
          const isActive = idx === game.currentPlayerIndex && !game.isOver;
          el.classList.toggle('active', isActive);
          el.classList.toggle('winner', !isActive && game.isOver && game.totalScores[idx] >= game.targetScore);
          elements.badges[idx].style.display = isActive ? 'inline-block' : 'none';
          elements.badges[idx].className = 'badge' + (isActive ? ' active' : (game.isOver && game.totalScores[idx] >= game.targetScore ? ' winner' : ''));
          elements.badges[idx].textContent = isActive ? 'ë‚´ í„´' : (game.isOver && game.totalScores[idx] >= game.targetScore ? 'ìŠ¹ë¦¬!' : '');
        });

        const disableActions = game.isOver;
        elements.rollBtn.disabled = disableActions;
        elements.holdBtn.disabled = disableActions;
        elements.forfeitBtn.disabled = disableActions;
      }

      function animateDice(face1, face2) {
        elements.dice.forEach(d => { d.classList.remove('roll'); void d.offsetWidth; d.classList.add('roll'); });
        setTimeout(() => {
          elements.dice[0].textContent = dieFaces[face1 - 1];
          elements.dice[1].textContent = dieFaces[face2 - 1];
          elements.dice[0].setAttribute('aria-label', `ì£¼ì‚¬ìœ„ 1: ${face1}`);
          elements.dice[1].setAttribute('aria-label', `ì£¼ì‚¬ìœ„ 2: ${face2}`);
        }, 160);
      }

      function checkWin() {
        const current = game.currentPlayerIndex;
        if (game.totalScores[current] >= game.targetScore) {
          game.isOver = true;
          elements.status.textContent = `í”Œë ˆì´ì–´ ${current + 1} ìŠ¹ë¦¬! ğŸ†`;
          showToast(`í”Œë ˆì´ì–´ ${current + 1}ê°€ ì´ê²¼ìŠµë‹ˆë‹¤!`);
          updateUI();
          return true;
        }
        return false;
      }

      function switchTurn(reason) {
        if (reason === 'rolledOne') {
          showToast('1ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤! í„´ì´ ë„˜ì–´ê°‘ë‹ˆë‹¤.');
        }
        game.turnAccumulated = 0;
        game.currentPlayerIndex = game.currentPlayerIndex === 0 ? 1 : 0;
        elements.status.textContent = `í”Œë ˆì´ì–´ ${game.currentPlayerIndex + 1}ì˜ í„´`;
        updateUI();
      }

      function roll() {
        if (game.isOver) return;
        playRollSound();
        const r1 = rand1to6();
        const r2 = rand1to6();
        animateDice(r1, r2);

        const hasOne = r1 === 1 || r2 === 1;
        const sum = r1 + r2;

        if (hasOne) {
          setTimeout(() => switchTurn('rolledOne'), 420);
        } else {
          game.turnAccumulated += sum;
          elements.status.textContent = `í•©ê³„ ${sum}ì ! ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
          setTimeout(updateUI, 180);
        }
      }

      function hold() {
        if (game.isOver) return;
        const idx = game.currentPlayerIndex;
        game.totalScores[idx] += game.turnAccumulated;
        showToast(`í”Œë ˆì´ì–´ ${idx + 1}: ${game.turnAccumulated}ì ì„ ì €ì¥`);
        game.turnAccumulated = 0;
        updateUI();
        if (!checkWin()) switchTurn('hold');
      }

      function forfeitTurn() {
        if (game.isOver) return;
        game.turnAccumulated = 0;
        showToast('í„´ì„ í¬ê¸°í–ˆìŠµë‹ˆë‹¤.');
        switchTurn('forfeit');
      }

      function resetGame() {
        game.totalScores = [0, 0];
        game.currentPlayerIndex = 0;
        game.turnAccumulated = 0;
        game.isOver = false;
        elements.dice[0].textContent = 'âš€';
        elements.dice[1].textContent = 'âš€';
        elements.status.textContent = 'í–‰ìš´ì„ ë¹Œì–´ìš”! ğŸ¯';
        updateUI();
      }

      elements.rollBtn.addEventListener('click', roll);
      elements.holdBtn.addEventListener('click', hold);
      elements.forfeitBtn.addEventListener('click', forfeitTurn);
      elements.resetBtn.addEventListener('click', resetGame);
      elements.target.addEventListener('change', () => {
        elements.target.value = String(game.targetScore);
        showToast(`ëª©í‘œ ì ìˆ˜: ${game.targetScore}`);
      });

      elements.helpBtn.addEventListener('click', () => {
        elements.backdrop.classList.add('show');
        elements.backdrop.setAttribute('aria-hidden', 'false');
      });
      elements.closeModal.addEventListener('click', () => {
        elements.backdrop.classList.remove('show');
        elements.backdrop.setAttribute('aria-hidden', 'true');
      });
      elements.backdrop.addEventListener('click', (e) => {
        if (e.target === elements.backdrop) {
          elements.backdrop.classList.remove('show');
          elements.backdrop.setAttribute('aria-hidden', 'true');
        }
      });

      window.addEventListener('keydown', (e) => {
        const tag = (e.target || {}).tagName || '';
        if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') return;
        if (e.key === 'r' || e.key === 'R' || e.code === 'Space') { e.preventDefault(); roll(); }
        if (e.key === 'h' || e.key === 'H') { e.preventDefault(); hold(); }
        if (e.key === 'n' || e.key === 'N') { e.preventDefault(); resetGame(); }
      });

      updateUI();
    </script>
  </body>
</html>